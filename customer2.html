<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Metamask and Bluetooth Control</title>

    <!-- Bağımlılıklar -->
    <script src="https://cdn.jsdelivr.net/npm/web3@1.3.5/dist/web3.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/web3modal@1.9.3/dist/web3modal.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@walletconnect/web3-provider@1.6.6/dist/cjs/index.js"></script>
</head>
<body>
    <br>
    <button onclick="Home()">Ana Sayfa</button>    
    
    <br><br><br>
    <h2>Mühür Açılışı!!!</h2>
    
    <button onclick="Challenge()">AÇ</button>
    <button onclick="requestLogin()">Giriş Yap</button>
    <button onclick="disconnect()">Bağlantıyı Kes</button>

    <script>
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        let port;
        let publicKey;
        let signature;
        let message;
        function Home(){ window.location.href = "/index.html";}

        async function Challenge(){}

        let web3Modal;
        let web3;

        window.onload = function() {
            const providerOptions = {
                walletconnect: {
                    package: WalletConnectProvider.default,
                    options: {
                        infuraId: "e77b488716694c61b48882014b8666b8"  // Infura ID'nizi buraya ekleyin
                    }
                }
            };

            web3Modal = new Web3Modal.default({
                network: "mainnet",
                cacheProvider: true,
                providerOptions
            });
        }

        async function requestLogin() {
            const provider = await web3Modal.connect();
            web3 = new Web3(provider);
            const accounts = await web3.eth.getAccounts();
            console.log("Connected accounts:", accounts);
        }

        function disconnect() {
            if (web3Modal.cachedProvider) {
                web3Modal.clearCachedProvider();
                console.log("Disconnected");
            }
        }
    </script>
</body>
</html>
